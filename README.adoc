Приложение для помощи при распечатывании брошюр
===============================================
(с) Лев О. Воробьёв <<lev.vorobyov@rambler.ru>>

:stem: latexmath

[abstract]
Программа предназначена для облегчения задачи ввода параметров печати брошюр с чётным количеством страниц на каждой стороне листа. Выполняет следующие функции: ввод данных (количество страниц на одной стороне листа, номер первой страницы, номер последней страницы); генерация двух последовательностей номеров страниц (для каждой стороны листа) для передачи их мастеру печати текстового процессора; отображение на экране в виде таблицы перечня листов и номеров страниц, распечатываемых на каждой стороне листа.

Язык программирования: С{pp}, Си, Ассемблер.

Вид и версия операционной системы: Windows XP, Vista, 7, 8, 10.

Объём программы для ЭВМ: 35,3 Кб.

== Введение

Под брошюрами здесь подразумевается согнутый вдвое лист бумаги с распечатанными на нём страницами с обеих сторон. На лицевой (внешней) стороне брошюры распечатана 4 и 1 страницы, а на внутренней 2 и 3 страницы.

Для распечатки брошюр размером А4 на листах формата А4 подойдут встроенные инструменты текстового процессора. Для распечатки же двух брошюр формата А5 на листах А4 можно воспользоваться данной программой.

== Описание пользовательского интерфейса

После запуска программы открывается окно ввода параметров:

[[fig_dialog]]
.Окно ввода параметров
image::fig/dialog.PNG[]

В этом окне пользователь вводит количество страниц на каждой стороне листа (на рис.{nbsp}<<fig_dialog>> соответствует полю «Страниц на листе», которое имеет следующие ограничения: stem:[k = 2^m, m \in \mathbb{N}]) и два из трёх параметров:

1. Количество страниц stem:[N = b - a + 1];
2. Номер первой страницы stem:[a = b - N + 1];
3. Номер последней страницы stem:[b = N + a - 1].

После ввода параметров и нажатия кнопки ОК открывается окно результатов:

[[fig_result]]
.Окно результатов
image::fig/result.PNG[]

Окно результатов (рис.{nbsp}<<fig_result>>) содержит следующие реквизиты:

1. Ориентация страниц (на рис.{nbsp}<<fig_result>> указана альбомная ориентация);
2. Диапазон страниц (на рис.{nbsp}<<fig_result>> указано с 3-й по 259-ю);
3. Необходимость добавления пустых страниц в конце документа для получения кратного количеству страниц на листе перечня номеров страниц;
4. Перечень номеров страниц для печати с лицевой стороны (на рис.{nbsp}<<fig_result>> поле «Лицевая сторона»);
5. Перечень номеров страниц для печати с обратной стороны (на рис.{nbsp}<<fig_result>> поле «Обратная сторона»).
6. Таблица листов с номерами страниц на лицевой и обратной сторонах.

Окно результатов (рис.{nbsp}<<fig_result>>) также содержит следующие элементы:

1. Кнопка пересчитать результаты, которая приводит к возврату на этап ввода параметров;
2. Меню «Справка» -> «О программе», которое приводит к появлению окна «О программе: Страницы 2.0» с указанием назначения программы и автора.

== Порядок действий

Итак, Вы подготовили документ в текстовом процессоре, который содержит N страниц, и Вам нужно сделать из него брошюры формата А5, но у Вас имеются листы формата А4. Для составления перечня номеров страниц Вам поможет данная программа.

1. Запустите программу нажав на значок приложения;
2. Введите N в первое поле окна ввода параметров (рис.{nbsp}<<fig_dialog>>);
3. Введите 4 во второе поле «Страниц на листе»;
4. Оставьте 1 в третьем поле «Первая страница» и нажмите ОК;
5. Откройте мастер печати в текстовом процессоре (обычно нажатием сочетания Ctrl + P);
6. Выберите указанную в окне результатов (рис.{nbsp}<<fig_result>>) ориентацию страниц;
6. Нажмите свойства принтера;
7. Укажите количество страниц на листе 4 с расположением их в порядке слева направо и сверху вниз;
8. Закройте свойства принтера;
9. В окне результатов (рис.{nbsp}<<fig_result>>) нажмите трижды без задержек более 1 секунды в поле ввода справа от надписи «Лицевая сторона»;
10. Нажмите комбинацию клавиш Ctrl + C;
11. В мастере печати установите курсор ввода в поле «Номера страниц»;
12. Нажмите кнопку Печать;
13. Поместите распечатанные листы во входной лоток принтера, перевернув их;
14. В окне результатов (рис.{nbsp}<<fig_result>>) нажмите трижды без задержек более 1 секунды в поле ввода справа от надписи «Обратная сторона»;
15. Нажмите комбинацию клавиш Ctrl + C;
16. В мастере печати установите курсор ввода в поле «Номера страниц»;
17. Нажмите кнопку Печать.
18. Разрежьте распечатанные листы и согните вдвое.

== Заключение

Данная программа рассматривается, как дополнение к программе подготовки текстовых документов и помогает распечатывать брошюры меньшего размера на листах большего  размера.

Направления дальнейшего развития:

- исправить ошибку, связанную с тем, что в таблице листов отбрасываются первые цифры номеров страниц;
- поменять порядок листов в последовательности номеров страниц для печати на обратной стороне для того, чтобы устранить необходимость изменения порядка распечатанных листов;
- внедрить алгоритм генерации последовательности номеров страниц в текстовый процессор, чтобы устранить необходимость копирования и вставки последовательностей страниц пользователем. 

Для разработки используйте систему сборки https://www.gnu.org/software/make[GNU Make] из пакета https://www.mingw-w64.org[MinGW]. Стандартный инструментарий Visual Studio эту программу не компилирует.

== Распространение

Программа распространяется на условиях лицензии http://opensource.org/licenses/MIT[MIT].

